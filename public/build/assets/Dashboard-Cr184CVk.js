import{a as N,r,j as e,H as w,b as P}from"./app-BoaIa35L.js";import{A as E}from"./AuthenticatedLayout-BMMSe8ZA.js";import{L as C}from"./loader-circle-DYd9EWeb.js";import"./ApplicationLogo-CT99op8B.js";function L(){const{flash:d,pdfs:h}=N().props,[c,b]=r.useState(null),[u,j]=r.useState(""),[n,m]=r.useState(!1),[o,p]=r.useState(d?.pdf_links||[]),[f,l]=r.useState(d?.message||""),[x,i]=r.useState([]),[g,y]=r.useState(";"),v=async s=>{if(s.preventDefault(),!c)return;const a=new FormData;a.append("csv_file",c),a.append("samplePdf",u),a.append("separator",g);try{m(!0),l(""),i([]),p([]);const t=await P.post("/build-pdf",a,{headers:{"Content-Type":"multipart/form-data"}});console.log("SUCCESS RESPONSE:",t.data),t.data.success?(p(t.data.pdf_links),l(t.data.message)):(l(t.data.message||"Something went wrong!"),t.data.errors&&i(Object.values(t.data.errors).flat()))}catch(t){if(console.log("ERROR RESPONSE:",t.response?.data),console.error(t),t.response?.status===422){const S=Object.values(t.response.data.errors).flat();i(S),l("Validation failed.")}else l("Failed to build PDF. Please try again.")}finally{m(!1)}};return e.jsxs(E,{title:"Home",children:[e.jsx(w,{title:"Home"}),e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] w-full px-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-xl shadow-lg p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 text-center",children:"Welcome to Home Page"}),e.jsxs("form",{onSubmit:v,className:"flex flex-col space-y-4",children:[e.jsx("label",{className:"font-medium text-gray-700",children:"Select Template File:"}),e.jsxs("select",{name:"samplePdf",value:u,onChange:s=>j(s.target.value),required:!0,className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select file"}),h.map((s,a)=>e.jsx("option",{value:s.id,children:s.title},a))]}),e.jsx("label",{className:"font-medium text-gray-700",children:"Upload CSV:"}),e.jsx("input",{type:"file",name:"csv_file",accept:".csv",required:!0,onChange:s=>b(s.target.files[0]),className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{className:"font-medium text-gray-700",children:"Separator:"}),e.jsx("input",{type:"text",name:"separator",value:g,onChange:s=>y(s.target.value),className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter separator",required:!0}),x.length>0&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 p-3 rounded",children:e.jsx("ul",{className:"list-disc list-inside text-sm",children:x.map((s,a)=>e.jsx("li",{children:s},a))})}),e.jsxs("button",{type:"submit",disabled:n,className:`px-6 py-3 text-white font-medium rounded-lg shadow focus:outline-none transition flex items-center justify-center gap-2 ${n?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:[n&&e.jsx(C,{className:"h-5 w-5 animate-spin"}),n?"Building...":"Build PDF"]})]}),f&&e.jsx("div",{className:`text-center text-lg font-medium ${o.length>0?"text-green-600":"text-red-600"}`,children:f}),o.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 justify-center",children:o.map((s,a)=>{const t=decodeURIComponent(s.split("/").pop());return e.jsxs("a",{href:`/download/${t}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-green-600 text-white font-medium rounded-lg shadow hover:bg-green-700 transition",children:["Download ",t]},a)})})]})})]})}export{L as default};
