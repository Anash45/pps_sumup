import{a as w,r,j as e,H as S,b as P}from"./app-C1Q_HFuD.js";import{A as C}from"./AuthenticatedLayout-DLGUg-a1.js";import{L as F}from"./loader-circle-B_4Vz4K8.js";import"./ApplicationLogo-B-a4k3O7.js";function L(){const{flash:d,pdfs:h}=w().props,[c,b]=r.useState(null),[u,j]=r.useState(""),[n,m]=r.useState(!1),[o,p]=r.useState(d?.pdf_links||[]),[f,l]=r.useState(d?.message||""),[x,i]=r.useState([]),[g,y]=r.useState(";"),v=async t=>{if(t.preventDefault(),!c)return;const a=new FormData;a.append("csv_file",c),a.append("samplePdf",u),a.append("separator",g);try{m(!0),l(""),i([]),p([]);const s=await P.post("/build-pdf",a,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")}});s.data.success?(p(s.data.pdf_links),l(s.data.message)):(l(s.data.message||"Something went wrong!"),s.data.errors&&i(Object.values(s.data.errors).flat()))}catch(s){if(console.error(s),s.response?.status===422){const N=Object.values(s.response.data.errors).flat();i(N),l("Validation failed.")}else l("Failed to build PDF. Please try again.")}finally{m(!1)}};return e.jsxs(C,{title:"Home",children:[e.jsx(S,{title:"Home"}),e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] w-full px-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-white rounded-xl shadow-lg p-6 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 text-center",children:"Welcome to Home Page"}),e.jsxs("form",{onSubmit:v,className:"flex flex-col space-y-4",children:[e.jsx("label",{className:"font-medium text-gray-700",children:"Select Template File:"}),e.jsxs("select",{name:"samplePdf",value:u,onChange:t=>j(t.target.value),required:!0,className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select file"}),h.map((t,a)=>e.jsx("option",{value:t.id,children:t.title},a))]}),e.jsx("label",{className:"font-medium text-gray-700",children:"Upload CSV:"}),e.jsx("input",{type:"file",name:"csv_file",accept:".csv",required:!0,onChange:t=>b(t.target.files[0]),className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{className:"font-medium text-gray-700",children:"Separator:"}),e.jsx("input",{type:"text",name:"separator",value:g,onChange:t=>y(t.target.value),className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter separator",required:!0}),x.length>0&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 p-3 rounded",children:e.jsx("ul",{className:"list-disc list-inside text-sm",children:x.map((t,a)=>e.jsx("li",{children:t},a))})}),e.jsxs("button",{type:"submit",disabled:n,className:`px-6 py-3 text-white font-medium rounded-lg shadow focus:outline-none transition flex items-center justify-center gap-2 ${n?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:[n&&e.jsx(F,{className:"h-5 w-5 animate-spin"}),n?"Building...":"Build PDF"]})]}),f&&e.jsx("div",{className:`text-center text-lg font-medium ${o.length>0?"text-green-600":"text-red-600"}`,children:f}),o.length>0&&e.jsx("div",{className:"flex flex-wrap gap-3 justify-center",children:o.map((t,a)=>{const s=decodeURIComponent(t.split("/").pop());return e.jsxs("a",{href:`/download/${s}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-green-600 text-white font-medium rounded-lg shadow hover:bg-green-700 transition",children:["Download ",s]},a)})})]})})]})}export{L as default};
